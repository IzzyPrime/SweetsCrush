
# 游戏的初步设计
1.Animation：动画控制器以及动画；
2.Prefabs：游戏预制体；
3.Scenes：游戏场景，包括开始画面和游戏画面；
4.Scripts：游戏脚本，包括方块生成脚本、方块移动脚本、方块颜色脚本等；
5.游戏核心算法：方块填充的算法、直线匹配的算法、L/T型匹配的算法、清除方块的算法等。

# 详细开发流程
## 预制体的制作：
- Grid：游戏方块的背景，于游戏方块的背景实例化中使用；
- NormalSweetPreFabs：普通游戏方块，包含交互部分和渲染部分，交互部分负责该方块的碰撞检测和脚本控制；渲染层只负责控制该游戏方块的外观；
- BarrierSweetPreFabs：障碍物方块，包含交互部分和渲染部分；
- ColomnSweetPreFabs：列消除方块，包含交互部分和渲染部分；
- RowSweetPreFabs：行消除方块，包含交互部分和渲染部分；
- RainbowSweetPreFabs：同色消除方块，包含交互部分和渲染部分；
- EmptySweetPreFabs：空方块，在游戏的填充算法中使用。

## 游戏管理（GameManager.cs）的设计：
- 游戏管理的脚本包括单例实例化、游戏方块的背景(m×n的巧克力格子)的实例化。
- 定义游戏方块的字典（sweetPrefabDict），以及游戏方块的类型枚举、结构体、游戏方块的生成与基础脚本的编写，游戏方块的字典可以让我们通过方块的种类来得到对应的游戏方块物体。
- 游戏方块移动脚本，判定游戏方块是否可以移动（GameSweet.cs中的CanMove方法）并更新游戏方块的位置（Move方法）。
- 游戏方块种类脚本，可以外部调用Color在脚本内通过SetColor方法来改变游戏中方块的种类。并且创建了一个空的游戏方块的预制体以及完成填充的核心算法使得游戏方块能够按照预期顺利生成。
- 实现游戏方块相邻方格之间的交换,编写两个游戏方块交换的方法。
- 添加消除脚本，使得匹配成功的游戏方块能够顺利消除，
- 编写行消除、列消除、同色消除的方法：消除的方块达四个则生成行消除或列消除游戏方块；消除的方块达五个及以上则生成同色消除游戏方块。行消除方块：消除该方块所在行的所有方块；列消除方块：消除该方块所在列的所有方块；同色消除方块：消除与该方块同色的所有方块。

## 游戏的核心算法:
- 填充的核心算法大致思路：从m×n方格的下方倒数第二行向上遍历，首先取到它的位置，并确定该游戏方块是否可以移动：其正下方是否是空方块。若是，则该方块向下移动，并在其原先位置生成新的空方块。由于上方第一行之上已经没有方块可以填充，所以在其之上创建一行不可见的方块 用来产生新方块，填充第一行中的空方块。 
-填充的核心算法的补充（斜向填充）：在之前算法的基础上增加对该游戏方块左下和右下是否为空方块的判定，若其左下和右下为空方块则判定该空方块上方是否为障碍物方块，若是则该方块填充至该空方块处。
- 直线匹配的算法的核心思路：以移动的两个游戏方块为基点开始遍历。需要三个列表：行列表、列列表、完成匹配列表。行、列列表分别遍历基点方块所在行和列的所有元素，判断是否有超过三个连续的相同颜色的游戏方块，若是，则将其加入完成匹配列表。完成以上步骤后return匹配列表，将其中元素所对应的游戏方块destroy即完成该轮匹配；若匹配列表为空则返回null，游戏方块位置的交换取消
-直线匹配算法的补充（L/T型匹配的算法）：在直线匹配的基础上，对已经完成匹配的方块的另两个方向的方块进行遍历。若有连续的且与已经完成匹配的方块同色的方块，则将其也添加进完成匹配列表。
- 清除障碍物的算法：遍历消除的所有游戏方块四周是否存在障碍物方块，若存在则清除。最后在清除游戏方块的方法中调用该算法。

## 游戏UI的补充：
制作游戏开始界面、游戏结算界面和游戏界面的分数和倒计时。并添加适当动画（使用Animation动画控制器制作）。